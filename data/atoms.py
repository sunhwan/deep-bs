_smina_atom_data = """{Hydrogen, EL_TYPE_H, AD_TYPE_H, XS_TYPE_SIZE,"Hydrogen", "H",	1.000000,	0.020000,	0.000510,	0.000000,	0.370000,	0.000000,	false,	false,	false,	false},
{PolarHydrogen, EL_TYPE_H, AD_TYPE_HD, XS_TYPE_SIZE,"PolarHydrogen", "HD",	1.000000,	0.020000,	0.000510,	0.000000,	0.370000,	0.000000,	false,	false,	false,	false},
{AliphaticCarbonXSHydrophobe, EL_TYPE_C, AD_TYPE_C, XS_TYPE_C_H,"AliphaticCarbonXSHydrophobe", "C",	2.000000,	0.150000,	-0.001430,	33.510300,	0.770000,	1.900000,	true,	false,	false,	false},
{AliphaticCarbonXSNonHydrophobe, EL_TYPE_C, AD_TYPE_C, XS_TYPE_C_P,"AliphaticCarbonXSNonHydrophobe", "C",	2.000000,	0.150000,	-0.001430,	33.510300,	0.770000,	1.900000,	false,	false,	false,	false},
{AromaticCarbonXSHydrophobe, EL_TYPE_C, AD_TYPE_A, XS_TYPE_C_H,"AromaticCarbonXSHydrophobe", "A",	2.000000,	0.150000,	-0.000520,	33.510300,	0.770000,	1.900000,	true,	false,	false,	false},
{AromaticCarbonXSNonHydrophobe, EL_TYPE_C, AD_TYPE_A, XS_TYPE_C_P,"AromaticCarbonXSNonHydrophobe", "A",	2.000000,	0.150000,	-0.000520,	33.510300,	0.770000,	1.900000,	false,	false,	false,	false},
{Nitrogen, EL_TYPE_N, AD_TYPE_N, XS_TYPE_N_P,"Nitrogen", "N",	1.750000,	0.160000,	-0.001620,	22.449300,	0.750000,	1.800000,	false,	false,	false,	true},
{NitrogenXSDonor, EL_TYPE_N, AD_TYPE_N, XS_TYPE_N_D,"NitrogenXSDonor", "N",	1.750000,	0.160000,	-0.001620,	22.449300,	0.750000,	1.800000,	false,	true,	false,	true},
{NitrogenXSDonorAcceptor, EL_TYPE_N, AD_TYPE_NA, XS_TYPE_N_DA,"NitrogenXSDonorAcceptor", "NA",	1.750000,	0.160000,	-0.001620,	22.449300,	0.750000,	1.800000,	false,	true,	true,	true},
{NitrogenXSAcceptor, EL_TYPE_N, AD_TYPE_NA, XS_TYPE_N_A,"NitrogenXSAcceptor", "NA",	1.750000,	0.160000,	-0.001620,	22.449300,	0.750000,	1.800000,	false,	false,	true,	true},
{Oxygen, EL_TYPE_O, AD_TYPE_O, XS_TYPE_O_P,"Oxygen", "O",	1.600000,	0.200000,	-0.002510,	17.157300,	0.730000,	1.700000,	false,	false,	false,	true},
{OxygenXSDonor, EL_TYPE_O, AD_TYPE_O, XS_TYPE_O_D,"OxygenXSDonor", "O",	1.600000,	0.200000,	-0.002510,	17.157300,	0.730000,	1.700000,	false,	true,	false,	true},
{OxygenXSDonorAcceptor, EL_TYPE_O, AD_TYPE_OA, XS_TYPE_O_DA,"OxygenXSDonorAcceptor", "OA",	1.600000,	0.200000,	-0.002510,	17.157300,	0.730000,	1.700000,	false,	true,	true,	true},
{OxygenXSAcceptor, EL_TYPE_O, AD_TYPE_OA, XS_TYPE_O_A,"OxygenXSAcceptor", "OA",	1.600000,	0.200000,	-0.002510,	17.157300,	0.730000,	1.700000,	false,	false,	true,	true},
{Sulfur, EL_TYPE_S, AD_TYPE_S, XS_TYPE_S_P,"Sulfur", "S",	2.000000,	0.200000,	-0.002140,	33.510300,	1.020000,	2.000000,	false,	false,	false,	true},
{SulfurAcceptor, EL_TYPE_S, AD_TYPE_SA, XS_TYPE_S_P,"SulfurAcceptor", "SA",	2.000000,	0.200000,	-0.002140,	33.510300,	1.020000,	2.000000,	false,	false,	false,	true},
{Phosphorus, EL_TYPE_P, AD_TYPE_P, XS_TYPE_P_P,"Phosphorus", "P",	2.100000,	0.200000,	-0.001100,	38.792400,	1.060000,	2.100000,	false,	false,	false,	true},
{Fluorine, EL_TYPE_F, AD_TYPE_F, XS_TYPE_F_H,"Fluorine", "F",	1.545000,	0.080000,	-0.001100,	15.448000,	0.710000,	1.500000,	true,	false,	false,	true},
{Chlorine, EL_TYPE_Cl, AD_TYPE_Cl, XS_TYPE_Cl_H,"Chlorine", "Cl",	2.045000,	0.276000,	-0.001100,	35.823500,	0.990000,	1.800000,	true,	false,	false,	true},
{Bromine, EL_TYPE_Br, AD_TYPE_Br, XS_TYPE_Br_H,"Bromine", "Br",	2.165000,	0.389000,	-0.001100,	42.566100,	1.140000,	2.000000,	true,	false,	false,	true},
{Iodine, EL_TYPE_I, AD_TYPE_I, XS_TYPE_I_H,"Iodine", "I",	2.360000,	0.550000,	-0.001100,	55.058500,	1.330000,	2.200000,	true,	false,	false,	true},
{Magnesium, EL_TYPE_Met, AD_TYPE_Mg, XS_TYPE_Met_D,"Magnesium", "Mg",	0.650000,	0.875000,	-0.001100,	1.560000,	1.300000,	1.200000,	false,	true,	false,	true},
{Manganese, EL_TYPE_Met, AD_TYPE_Mn, XS_TYPE_Met_D,"Manganese", "Mn",	0.650000,	0.875000,	-0.001100,	2.140000,	1.390000,	1.200000,	false,	true,	false,	true},
{Zinc, EL_TYPE_Met, AD_TYPE_Zn, XS_TYPE_Met_D,"Zinc", "Zn",	0.740000,	0.550000,	-0.001100,	1.700000,	1.310000,	1.200000,	false,	true,	false,	true},
{Calcium, EL_TYPE_Met, AD_TYPE_Ca, XS_TYPE_Met_D,"Calcium", "Ca",	0.990000,	0.550000,	-0.001100,	2.770000,	1.740000,	1.200000,	false,	true,	false,	true},
{Iron, EL_TYPE_Met, AD_TYPE_Fe, XS_TYPE_Met_D,"Iron", "Fe",	0.650000,	0.010000,	-0.001100,	1.840000,	1.250000,	1.200000,	false,	true,	false,	true},
{GenericMetal, EL_TYPE_Met, AD_TYPE_METAL, XS_TYPE_Met_D,"GenericMetal", "M",	1.200000,	0.000000,	-0.001100,	22.449300,	1.750000,	1.200000,	false,	true,	false,	true}
{Boron, EL_TYPE_B, AD_TYPE_B, XS_TYPE_B_H,"Boron", "B",	2.000000,	0.150000,	-0.001430,	33.510300,	0.770000,	1.900000,	true,	false,	false,	false},
"""

class SminaAtomType:
    Hydrogen = 1
    PolarHydrogen = 2
    AliphaticCarbonXSHydrophobe = 3
    AliphaticCarbonXSNonHydrophobe = 4
    AromaticCarbonXSHydrophobe = 5
    AromaticCarbonXSNonHydrophobe = 6
    Nitrogen = 7
    NitrogenXSDonor = 8
    NitrogenXSDonorAcceptor = 9
    NitrogenXSAcceptor = 10
    Oxygen = 11
    OxygenXSDonor = 12
    OxygenXSDonorAcceptor = 13
    OxygenXSAcceptor = 14
    Sulfur = 15
    SulfurAcceptor = 16
    Phosphorus = 17
    Fluorine = 18
    Chlorine = 19
    Bromine = 20
    Iodine = 21
    Magnesium = 22
    Manganese = 23
    Zinc = 24
    Calcium = 25
    Iron = 26
    GenericMetal = 27
    Boron = 28

class Element:
    H    =  0;
    C    =  1;
    N    =  2;
    O    =  3;
    S    =  4;
    P    =  5;
    F    =  6;
    Cl   =  7;
    Br   =  8;
    I    =  9;
    Met  = 10;
    SIZE = 11;
    B = 12

class AutoDockType:
    C    =  0;
    A    =  1;
    N    =  2;
    O    =  3;
    P    =  4;
    S    =  5;
    H    =  6;
    F    =  7;
    I    =  8;
    NA   =  9;
    OA   = 10;
    SA   = 11;
    HD   = 12;
    Mg   = 13;
    Mn   = 14;
    Zn   = 15;
    Ca   = 16;
    Fe   = 17;
    Cl   = 18;
    Br   = 19;
    METAL = 20;
    B    = 21

class XSType:
    C_H   =  0;
    C_P   =  1;
    N_P   =  2;
    N_D   =  3;
    N_A   =  4;
    N_DA  =  5;
    O_P   =  6;
    O_D   =  7;
    O_A   =  8;
    O_DA  =  9;
    S_P   = 10;
    P_P   = 11;
    F_H   = 12;
    Cl_H  = 13;
    Br_H  = 14;
    I_H   = 15;
    Met_D = 16;
    SIZE  = 17
    B_H   = 18


class AtomData:
    def __init__(self):
        self.data = []
        self.adtype_map = {}
        self.xstype_map = {}
        self.sminatype_map = {}
        for line in _smina_atom_data.splitlines():
            token = [_.strip() for _ in line.strip()[1:-2].split(',')]

            entry = {
                'element': getattr(Element, token[1].split('_')[-1]),
                'smina_type': getattr(SminaAtomType, token[0]),
                'autodock_type': getattr(AutoDockType, token[2].split('_')[-1]),
                'xs_type': getattr(XSType, token[3][8:]),
                'smina_name': token[4][1:-1],
                'autodock_name': token[5][1:-1],
                'autodock_radius': float(token[6]),
                'autodock_depth': float(token[7]),
                'autodock_solvation': float(token[8]),
                'autodock_volume': float(token[9]),
                'bond_radius': float(token[10]),
                'xs_radius': float(token[11]),
                'xs_hydrophobe': token[12] == 'true',
                'xs_donor': token[13] == 'true',
                'xs_acceptor': token[14] == 'true',
                'xs_heteroatom': token[15] == 'true',
            }
            self.adtype_map[entry['autodock_type']] = len(self.data)
            self.sminatype_map[entry['smina_type']] = len(self.data)
            # this should be at the end
            self.data.append(entry)
    
    def __getitem__(self, index):
        return self.data[index]

    def query_adtype(self, autodock_type):
        if autodock_type in ['Na', 'Co', 'Ni', 'Cu', 'K', 'Hg', 'Se', 'Sr', 'Cs', 'Cd']:
            autodock_type = 'METAL'
        return self.adtype_map[getattr(AutoDockType, autodock_type)]

    def query_xstype(self, xs_type):
        return self.xstype_map[getattr(XSType, xs_type)]

    def query_sminatype(self, smina_type):
        return self.sminatype_map[getattr(SminaAtomType, smina_type)]

    def query(self, type_key, type_filter):
        """Query atom data using "type_key" and "type_filter"
           type_key: [smina_type|element]
           type_filter: numeric atom type
        """
        if type_key == 'smina_type':
            return self.data[self.sminatype_map[type_filter]]

